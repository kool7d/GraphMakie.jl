<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interaction Examples Â· GraphMakie.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://JuliaPlots.github.io/GraphMakie.jl/generated/interactions/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GraphMakie.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../plots/">Plot Examples</a></li><li class="is-active"><a class="tocitem" href>Interaction Examples</a><ul class="internal"><li><a class="tocitem" href="#Hover-interactions"><span>Hover interactions</span></a></li><li><a class="tocitem" href="#Click-interactions"><span>Click interactions</span></a></li><li><a class="tocitem" href="#Drag-interactions"><span>Drag interactions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interaction Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interaction Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaPlots/GraphMakie.jl/blob/master/docs/examples/interactions.jl" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Add-interactions-to-your-graph-plot"><a class="docs-heading-anchor" href="#Add-interactions-to-your-graph-plot">Add interactions to your graph plot</a><a id="Add-interactions-to-your-graph-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Add-interactions-to-your-graph-plot" title="Permalink"></a></h1><p>In this example you will see, how to register interactions with your graph plot. We star with a simple wheel graph again. This time we use arrays for some attributes because we want to change them later in the interactions for individual nodes/edges.</p><pre><code class="language-">using CairoMakie
CairoMakie.activate!(type=&quot;png&quot;) # hide
set_theme!(resolution=(800, 400)) #hide
CairoMakie.inline!(true) # hide
using GraphMakie
using LightGraphs
using CairoMakie.Colors

import Random; Random.seed!(2) # hide
g = wheel_graph(10)
f, ax, p = graphplot(g,
                     edge_width = [2.0 for i in 1:ne(g)],
                     edge_color = [colorant&quot;gray&quot; for i in 1:ne(g)],
                     node_size = [10 for i in 1:nv(g)],
                     node_color = [colorant&quot;red&quot; for i in 1:nv(g)])
hidedecorations!(ax); hidespines!(ax)
ax.aspect = DataAspect()
f # hide</code></pre><p>Later on we want to enable drag interactions, therefore we disable the default <code>:rectanglezoom</code> interaction</p><pre><code class="language-">deregister_interaction!(ax, :rectanglezoom)
nothing #hide</code></pre><h2 id="Hover-interactions"><a class="docs-heading-anchor" href="#Hover-interactions">Hover interactions</a><a id="Hover-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Hover-interactions" title="Permalink"></a></h2><p>At first, let&#39;s add some hover interaction for our nodes using the <a href="../../#GraphMakie.NodeHoverHandler"><code>NodeHoverHandler</code></a> constructor. We need to define a action function with the signature <code>fun(state, idx, event, axis)</code>. We use the action to make the nodes bigger on hover events.</p><pre><code class="language-">function node_hover_action(state, idx, event, axis)
    @info idx #hide
    p.node_size[][idx] = state ? 20 : 10
    p.node_size[] = p.node_size[] # trigger observable
end
nhover = NodeHoverHandler(node_hover_action)
register_interaction!(ax, :nhover, nhover)

function set_cursor!(p) #hide
    direction = Point2f0(-0.1, 0.2) #hide
    arrows!([p-direction], [direction], linewidth=3, arrowsize=20, lengthscale=0.8) #hide
end #hide
nodepos = copy(p[:node_positions][]) #hide
set_cursor!(nodepos[5] + Point2f0(0.05, 0)) #hide
p.node_size[][5] = 20; p.node_size[] = p.node_size[] #hide
f #hide</code></pre><p>Please run the script locally with <code>GLMakie.jl</code> if you want to play with the Graph ðŸ™‚ The edge hover interaction is quite similar:</p><pre><code class="language-">pop!(ax.scene.plots) #hide
p.node_size[][5] = 10; p.node_size[] = p.node_size[] #hide
function edge_hover_action(state, idx, event, axis)
    @info idx #hide
    p.edge_width[][idx]= state ? 5.0 : 2.0
    p.edge_width[] = p.edge_width[] # trigger observable
end
ehover = EdgeHoverHandler(edge_hover_action)
register_interaction!(ax, :ehover, ehover)

set_cursor!((nodepos[4]+nodepos[1])/2) #hide
p.edge_width[][3] = 5.0; p.edge_width[] = p.edge_width[] #hide
f #hide</code></pre><h2 id="Click-interactions"><a class="docs-heading-anchor" href="#Click-interactions">Click interactions</a><a id="Click-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Click-interactions" title="Permalink"></a></h2><p>In a similar fashion we might change the color of nodes and lines by click.</p><pre><code class="language-">function node_click_action(idx, args...)
    p.node_color[][idx] = rand(RGB)
    p.node_color[] = p.node_color[]
end
nclick = NodeClickHandler(node_click_action)
register_interaction!(ax, :nclick, nclick)

function edge_click_action(idx, args...)
    p.edge_color[][idx] = rand(RGB)
    p.edge_color[] = p.edge_color[]
end
eclick = EdgeClickHandler(edge_click_action)
register_interaction!(ax, :eclick, eclick)

p.edge_color[][3] = colorant&quot;blue&quot;; p.edge_color[] = p.edge_color[] #hide
p.node_color[][7] = colorant&quot;yellow&quot; #hide
p.node_color[][2] = colorant&quot;brown&quot; #hide
p.node_color[][9] = colorant&quot;pink&quot; #hide
p.node_color[][6] = colorant&quot;green&quot; #hide
p.node_color[] = p.node_color[] #hide
f #hide</code></pre><h2 id="Drag-interactions"><a class="docs-heading-anchor" href="#Drag-interactions">Drag interactions</a><a id="Drag-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Drag-interactions" title="Permalink"></a></h2><pre><code class="language-">pop!(ax.scene.plots) #hide
p.edge_width[][3] = 2.0; p.edge_width[] = p.edge_width[] #hide
function node_drag_action(state, idx, event, axis)
    p[:node_positions][][idx] = event.data
    p[:node_positions][] = p[:node_positions][]
end
ndrag = NodeDragHandler(node_drag_action)
register_interaction!(ax, :ndrag, ndrag)

p[:node_positions][][1] = nodepos[1] + Point2f0(1.0,0.5) #hide
p[:node_positions][] = p[:node_positions][] #hide
set_cursor!(p[:node_positions][][1] + Point2f0(0.05, 0)) #hide
p.node_size[][1] = 20; p.node_size[] = p.node_size[] #hide
f # hide</code></pre><p>The last example is not as straight forward. By dragging an edge we want to change the positions of both attached nodes. Therefore we need some more state inside the action. We can achieve this with a callable struct.</p><pre><code class="language-">pop!(ax.scene.plots) #hide
p.node_size[][1] = 10; p.node_size[] = p.node_size[] #hide
mutable struct EdgeDragAction
    init::Union{Nothing, Point2f0} # save click position
    src::Union{Nothing, Point2f0}  # save src vertex position
    dst::Union{Nothing, Point2f0}  # save dst vertex position
    EdgeDragAction() = new(nothing, nothing, nothing)
end
function (action::EdgeDragAction)(state, idx, event, axis)
    edge = collect(edges(g))[idx]
    if state == true
        if action.src===action.dst===action.init===nothing
            action.init = event.data
            action.src = p[:node_positions][][edge.src]
            action.dst = p[:node_positions][][edge.dst]
        end
        offset = event.data - action.init
        p[:node_positions][][edge.src] = action.src + offset
        p[:node_positions][][edge.dst] = action.dst + offset
        p[:node_positions][] = p[:node_positions][] # trigger change
    elseif state == false
        action.src = action.dst = action.init =  nothing
    end
end
edrag = EdgeDragHandler(EdgeDragAction())
register_interaction!(ax, :edrag, edrag)

p[:node_positions][][3] = nodepos[3] + Point2f0(0.9,1.0) #hide
p[:node_positions][][4] = nodepos[4] + Point2f0(0.9,1.0) #hide
p[:node_positions][] = p[:node_positions][] #hide
pm = (p[:node_positions][][3] + p[:node_positions][][4])/2
set_cursor!(pm) #hide
p.edge_width[][11] = 5.0; p.edge_width[] = p.edge_width[] #hide
f # hide</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plots/">Â« Plot Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 29 June 2021 00:36">Tuesday 29 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
